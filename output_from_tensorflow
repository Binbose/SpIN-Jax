sigma_bar
 [[ 9.9016678e-01  8.9170120e-05  4.6357145e-05 -2.1478388e-04]
 [ 8.9170120e-05  9.9004787e-01  2.4572708e-05 -1.1520534e-04]
 [ 4.6357145e-05  2.4572708e-05  9.9001324e-01 -5.9223337e-05]
 [-2.1478388e-04 -1.1520534e-04 -5.9223337e-05  9.9027735e-01]]

j_sigma_bar
 [[[[ 9.0819481e-07 -1.0661025e-06 -6.6883140e-06 ... -2.6585149e-06
    -1.7818113e-06 -1.0602615e-06]
   [ 5.1905158e-07 -6.5766301e-07 -3.7759262e-06 ... -1.5596510e-06
    -1.1229040e-06 -5.6789230e-07]]

  [[-2.5419387e-09  7.7245759e-06  4.6693782e-07 ...  7.1581576e-07
    -4.5088538e-07 -2.8858022e-07]
   [-3.7704337e-09  4.4240687e-06  3.5042339e-07 ...  4.4760395e-07
    -2.2268947e-07 -1.2720240e-07]]

  [[-6.0277534e-06  9.6511440e-07 -9.6007398e-06 ... -2.9251798e-06
     3.8675292e-08 -2.9006287e-07]
   [-3.4060145e-06  5.6278378e-07 -5.4939978e-06 ... -1.7399735e-06
     7.2985927e-08 -1.9551591e-07]]

  [[ 8.5134575e-09  1.0390979e-05 -3.2648393e-07 ...  1.4518137e-06
     3.0052735e-07  4.5982752e-06]
   [-6.1027796e-09  6.1142373e-06 -2.5445829e-07 ...  8.8466567e-07
     2.2093545e-07  2.5194718e-06]]]


 [[[ 4.7430720e-07 -5.6301673e-07 -3.4825778e-06 ... -1.3878895e-06
    -9.3608037e-07 -5.4871907e-07]
   [ 2.7652925e-07 -3.5357064e-07 -2.0061163e-06 ... -8.3037150e-07
    -6.0067930e-07 -2.9998333e-07]]

  [[-1.0195815e-09  4.0233022e-06  2.5013853e-07 ...  3.7573147e-07
    -2.3183257e-07 -1.4777480e-07]
   [-1.8217055e-09  2.3508098e-06  1.8968701e-07 ...  2.3928609e-07
    -1.1681719e-07 -6.6358389e-08]]

  [[-3.1376874e-06  5.0329385e-07 -5.0027220e-06 ... -1.5298918e-06
     2.4690385e-08 -1.5414311e-07]
   [-1.8090448e-06  2.9934372e-07 -2.9206083e-06 ... -9.2779823e-07
     4.1082664e-08 -1.0546565e-07]]

  [[ 3.7263637e-09  5.4236161e-06 -1.7221589e-07 ...  7.6142243e-07
     1.6127285e-07  2.3873024e-06]
   [-3.5860830e-09  3.2545818e-06 -1.3609869e-07 ...  4.7276825e-07
     1.1981925e-07  1.3350163e-06]]]


 [[[ 2.7276158e-07 -3.1150532e-07 -2.0210132e-06 ... -7.9631656e-07
    -5.2347178e-07 -3.2534848e-07]
   [ 1.4295331e-07 -1.7654838e-07 -1.0456574e-06 ... -4.2743486e-07
    -3.0172606e-07 -1.6003762e-07]]

  [[-8.8874796e-10  2.3290495e-06  1.2925267e-07 ...  2.1081223e-07
    -1.4092048e-07 -9.1721127e-08]
   [-9.9932274e-10  1.2211513e-06  8.9935192e-08 ...  1.2054241e-07
    -6.4386924e-08 -3.8032560e-08]]

  [[-1.8220542e-06  2.8979338e-07 -2.8930435e-06 ... -8.7216642e-07
     4.3303645e-09 -8.2830134e-08]
   [-9.4332336e-07  1.5458593e-07 -1.5160779e-06 ... -4.7471144e-07
     1.5898246e-08 -5.1381875e-08]]

  [[ 3.9059231e-09  3.1122056e-06 -9.2153947e-08 ...  4.2962745e-07
     8.3235832e-08  1.4006382e-06]
   [-8.4852642e-10  1.6749608e-06 -6.5746981e-08 ...  2.3959868e-07
     5.6792341e-08  7.0421964e-07]]]


 [[[-1.1433384e-06  1.3550209e-06  8.3999530e-06 ...  3.3476390e-06
     2.2571858e-06  1.3244697e-06]
   [-6.6823839e-07  8.5337786e-07  4.8510765e-06 ...  2.0086975e-06
     1.4534287e-06  7.2577467e-07]]

  [[ 2.7648492e-09 -9.7060874e-06 -6.0228933e-07 ... -9.0607773e-07
     5.5981212e-07  3.5659377e-07]
   [ 4.6658619e-09 -5.6867998e-06 -4.5892182e-07 ... -5.7900206e-07
     2.8258714e-07  1.6016538e-07]]

  [[ 7.5688431e-06 -1.2141884e-06  1.2067201e-05 ...  3.6892836e-06
    -5.8651125e-08  3.7104112e-07]
   [ 4.3751479e-06 -7.2425672e-07  7.0638348e-06 ...  2.2439822e-06
    -9.9260831e-08  2.5483376e-07]]

  [[-9.0016519e-09 -1.3083436e-05  4.1687045e-07 ... -1.8356150e-06
    -3.8793175e-07 -5.7596358e-06]
   [ 8.7904848e-09 -7.8742842e-06  3.3106977e-07 ... -1.1432807e-06
    -2.8953991e-07 -3.2284843e-06]]]]

pi
 [[-0.02848263 -0.01550291 -0.00660767  0.04258637]
 [-0.01561597 -0.00854498 -0.00360877  0.02335017]
 [-0.0074306  -0.00399199 -0.00174917  0.01111737]
 [ 0.03744879  0.02046972  0.00865497 -0.05598932]]

params first weight matrix
 [[ 0.2158123   0.40102696  0.29594025  0.1645028  -0.46684694 -1.5952657
  -0.3767632   0.7374016  -0.2764243   0.5698539  -1.1550243   0.8754668
  -0.3066122  -0.07784102 -0.4334716  -0.8435004  -0.22485891 -0.32613477
  -0.08494689  0.49611473  1.4300975  -0.8533776   1.1094263  -0.5251151
   0.7377106   1.641263    0.06273685 -1.0552179   1.2228442  -0.8194827
   0.757038   -0.27657828 -0.33616304  0.11325539 -0.0225246  -0.014411
   1.3388667   0.51871943 -0.6437544   0.04646486  0.2677782  -0.45956704
  -0.14613365  0.17763013  0.29212937 -0.03140214  0.3752061   1.2674235
   0.02655751  0.10672531  0.02751984  1.2143444   0.7139318  -0.00758244
   0.85815334  0.21852477 -0.90497524 -1.091844   -0.25155836 -0.53929174
   0.6542095   0.96265054  0.18663973  0.04547725  0.07282059  0.22777286
   0.3426331   0.03587491  0.66259503  0.61080873  0.23003046 -0.15558316
  -0.08784031  0.06003841  0.49953395 -0.11547589 -0.73715687  0.45995757
   0.39368176 -0.3105633   0.34459445 -0.40985158  0.03021792  1.0098289
  -0.06115246  1.3194695   1.0213201  -0.56860274  0.2743764   0.56150734
  -0.4044792   1.6436645  -0.6938326  -0.52691245 -0.1597578   0.12485599
   0.3476172  -1.3221971   0.5257708  -0.01677212  0.4387947  -0.08738045
  -0.27979395 -0.13201895 -0.66555864  0.30673796  0.14230762 -0.46208653
   1.355289   -0.11111859  0.58131003 -0.08650244 -0.99015397  0.51896757
   0.63733226  0.09500775 -0.87759304  0.01954114  0.9257647  -0.03010255
   0.23717892  0.00246268 -0.64213216 -0.10535139 -0.4154258  -0.21528088
  -0.61781204  0.5931215 ]
 [-0.55206096  0.6174683  -0.98377395 -0.00578077  0.17710586 -0.2600046
  -0.83735335 -0.67482483  0.17027935 -0.05283271 -0.82167506  1.465819
   0.86072487  0.73311895 -0.323503    0.7472555   0.01300499 -0.39755887
   0.07196485  1.2789934  -0.36561653 -0.9577291  -1.00919    -0.80224645
   0.09032361 -1.1719271   0.86344486 -0.07219411 -0.43177986 -0.7780976
  -0.13840933 -0.81922185  0.49806836 -1.5129075   0.5752646  -0.45279923
   0.22994643 -0.00525576  0.36167604  0.44427556  0.10741867  0.5358421
   0.14900544  0.82397324 -0.56948024 -0.66191405 -0.3186086  -0.62061507
   0.10558807  0.30980673 -1.0557534  -0.80061543 -0.28608158 -0.82289594
  -0.9686491  -0.8190719   0.5590539   0.11630179 -0.84460455  0.3974045
  -0.25601166  1.632178    0.3137089   0.16809173 -0.09281489 -1.2603076
   0.8015154  -0.05750954 -0.1698283  -1.1474941  -0.22096558 -0.18376698
  -0.998739    0.11938852 -0.5972109  -1.9254985   0.99553037 -0.55052525
  -0.20824696  0.7523735  -1.2542474   0.4018734  -1.2822275   0.0170772
  -0.96592474  0.78865564  0.99856544  0.40985736  0.15094413  0.20161408
   0.57007813  1.2141099  -0.12527002 -0.61202186  0.71862805  0.9095453
  -1.0956368   0.7031715  -1.553277    0.7191077   1.0414608   0.11977377
  -1.6985183  -0.49675366 -1.1987516  -1.56533    -0.5059429   0.3845466
  -0.9749926   0.18327323 -0.67756295  0.01105606 -0.8813949   0.74238986
  -0.32455942 -0.10440999  0.02928554  0.12570043 -0.26823974 -0.28052628
  -0.5632943  -0.82184505 -0.6582297  -0.4807399  -0.30351365 -0.20770793
  -0.10025077 -0.47661948]]

chol
 [[ 9.95071232e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 8.96117926e-05  9.95011449e-01  0.00000000e+00  0.00000000e+00]
 [ 4.65867597e-05  2.46917061e-05  9.94994104e-01  0.00000000e+00]
 [-2.15847744e-04 -1.15763476e-04 -5.95083184e-05  9.95126784e-01]]

eigval
 [-0.02905111 -0.00871189 -0.0017829  -0.05704556]

loss
 -0.09751654

loss_back first weight matrix
 [[ 1.58648865e-04  1.34191464e-03  1.71506603e-03 -4.05463616e-05
   4.45474230e-04 -1.34485017e-04 -6.65245112e-04 -1.10252178e-03
  -1.17015210e-03 -3.05316178e-04  4.89705126e-04 -3.63934145e-04
  -1.95335294e-03 -1.77653471e-03 -5.49732184e-04 -3.13560304e-04
  -2.36557273e-04 -1.58975105e-04  1.11131510e-03 -2.07713526e-03
  -1.53381261e-03 -2.27606739e-04 -5.25275420e-04  4.50637715e-04
  -7.10567168e-04 -1.70491473e-03 -1.11594563e-03 -7.08151856e-06
   1.96335278e-03  4.74622939e-05 -1.93773664e-03  4.05905739e-05
   1.42912992e-04  1.48805644e-04  6.02836430e-04 -2.74290913e-04
  -6.21537911e-04  1.65401580e-04  6.92737929e-04 -1.08816021e-03
  -1.99605580e-04  2.26696902e-05  6.10870717e-04  1.78464153e-03
  -4.73568391e-04 -5.15834836e-04  7.57203321e-04  9.01305582e-04
   2.66722258e-04 -1.76059280e-03  3.72122973e-04  1.20642851e-03
  -1.26434083e-03 -1.83290034e-03  6.49925380e-04 -7.85349985e-04
   2.70044984e-05 -1.85359822e-05  7.38882227e-05  9.42843617e-05
  -4.94146720e-04  1.58037327e-03  2.23766896e-03 -2.81676446e-04
   1.57647580e-03 -3.58462557e-06 -9.33558331e-04 -1.07851356e-05
   7.51308631e-04 -1.60755138e-04 -1.59289828e-03  5.60919521e-04
   2.01315997e-04  6.95773924e-04  1.76442700e-04  7.97538232e-05
  -1.61838601e-04 -4.04292857e-03  5.42564521e-06 -1.46980194e-04
  -1.71916545e-05 -8.01695278e-05  2.36093940e-04 -4.31195047e-04
  -7.22826953e-05  1.47320912e-03 -1.41294999e-03  4.77366062e-04
   3.21018044e-04  2.68162839e-04 -4.61206975e-04 -1.50864385e-03
  -9.81225967e-05 -2.83576257e-04  5.66321076e-04  7.94252963e-04
   3.12509859e-04  7.40487303e-06  9.41606413e-04  9.99466865e-05
  -3.06460797e-03  4.66249650e-04  1.88573467e-04  1.49401923e-04
  -4.47397935e-04  2.88953515e-06 -6.28824637e-05  6.19947910e-04
  -4.07751463e-03 -6.62946200e-04  2.96834274e-03 -2.04484706e-04
   7.73839565e-05  1.78903865e-03 -9.43826861e-04  7.41365715e-04
   8.44335300e-05 -7.32642889e-04 -1.59246032e-03  2.90775293e-04
   4.05390601e-04  5.57173393e-04  8.23095499e-04  2.57087493e-04
   3.19224637e-05  6.40956801e-04  1.24944680e-04  1.62580714e-03]
 [ 1.13100650e-04  9.59534431e-04 -2.69015960e-04  2.95559788e-04
   5.10000449e-04  2.31433049e-04 -7.36756920e-06 -3.08069575e-04
  -7.87911995e-04 -1.22317331e-04  4.83999174e-05 -1.06658787e-04
  -3.30046983e-03 -2.64766393e-03 -6.75302814e-04 -3.09072348e-04
   1.57779374e-04  1.75175359e-04  5.99231105e-04 -1.48189336e-03
  -8.13630293e-04  7.47797676e-05  4.18460259e-05  2.96288665e-04
  -3.99839570e-04  9.69385728e-05 -9.46692657e-04  2.12913146e-05
   9.77477059e-04  3.11414886e-04 -8.08812794e-04  9.31968680e-06
   5.53715043e-04 -4.71621606e-05  4.43229452e-04 -4.89151862e-05
  -5.61374356e-04 -1.87882441e-04  1.32965599e-03 -1.08255376e-03
  -5.08672441e-04  1.29924490e-04  7.06151885e-04  1.74384599e-03
   1.70280429e-04 -5.23431081e-05  7.28421030e-04  6.07598224e-04
  -3.48349829e-04 -1.27093273e-03  1.84625722e-04 -4.74203262e-06
  -4.86084988e-04 -6.52244897e-04  2.39047309e-04 -2.19098496e-04
  -6.91440713e-04  2.17805471e-04 -1.77016045e-06  9.30203023e-05
  -3.03560926e-04  2.05286266e-03  2.17757421e-03  2.43728282e-04
   1.25790923e-03 -8.78219435e-05 -4.07573389e-04  8.15643871e-05
   4.65575431e-04  8.18058834e-06 -1.76259957e-03  5.36567182e-04
   2.53146191e-05  4.50847670e-04 -4.55752655e-04  2.51903839e-05
  -6.03559776e-04 -2.07523070e-03  7.23343765e-05  1.86717996e-04
  -1.51821936e-04  1.30139815e-04 -1.45385973e-04 -1.32697460e-04
   3.06675793e-05  8.11549427e-04 -1.04367919e-03  6.02636661e-04
   1.12564434e-04  5.36704902e-04 -1.80129282e-04 -5.54432510e-04
   1.24870276e-05 -1.74522633e-04  1.40046549e-03  1.19202887e-03
  -3.65002634e-04  1.49084633e-04 -2.86092720e-04  3.05051100e-04
  -2.27242522e-03  1.42588397e-04 -1.30267508e-04  9.77994132e-05
   2.93681602e-04  9.82040001e-05 -2.52248836e-04  1.33808970e-03
  -6.81235106e-04 -4.27185791e-04  5.02387353e-04 -1.14680290e-04
  -7.36132279e-05  1.04783522e-03 -1.88835504e-04  5.04123687e-04
   2.92445853e-04 -9.44912259e-04 -6.11575961e-04  5.44528157e-05
   8.90002048e-06 -1.84318942e-05  5.24935545e-04  1.00784164e-04
   6.76217896e-05  3.24773428e-04  2.29377198e-04  2.81489774e-04]]

output of `tf.gradients(loss, sigma_avg)` (no [0])
 [array([[ 0.03143993,  0.01710427,  0.00728755, -0.04685143],
       [-0.        ,  0.00942798,  0.00398015, -0.02569025],
       [-0.        , -0.        ,  0.00192907, -0.0122289 ],
       [-0.        , -0.        , -0.        ,  0.06159973]],
      dtype=float32)]

sigma_back
 [[ 0.03206695  0.01744364  0.00743158 -0.04775301]
 [-0.          0.00961511  0.00405883 -0.02618492]
 [-0.         -0.          0.00196719 -0.01246383]
 [-0.         -0.         -0.          0.06278573]]

final grad first weight matrix
 [[ 1.54080393e-04  1.30335079e-03  1.66493247e-03 -3.90599489e-05
   4.32452536e-04 -1.30841276e-04 -6.45906490e-04 -1.06985611e-03
  -1.13596732e-03 -2.96473299e-04  4.74845408e-04 -3.53463809e-04
  -1.89648126e-03 -1.72510813e-03 -5.33539278e-04 -3.04540823e-04
  -2.29739453e-04 -1.54421767e-04  1.07905676e-03 -2.01636995e-03
  -1.48961158e-03 -2.21128023e-04 -5.09121281e-04  4.37170558e-04
  -6.89973705e-04 -1.65714079e-03 -1.08363375e-03 -6.88988302e-06
   1.90663897e-03  4.58628747e-05 -1.88085798e-03  3.93824303e-05
   1.38714662e-04  1.44531979e-04  5.85280592e-04 -2.66520365e-04
  -6.03806053e-04  1.61689080e-04  6.72416121e-04 -1.05664670e-03
  -1.93467131e-04  2.19819904e-05  5.93230128e-04  1.73254369e-03
  -4.60846437e-04 -5.01172908e-04  7.34821137e-04  8.75915575e-04
   2.59059074e-04 -1.70990720e-03  3.61163664e-04  1.17249053e-03
  -1.22747128e-03 -1.77916442e-03  6.30822266e-04 -7.62463722e-04
   2.64570099e-05 -1.80149691e-05  7.17908406e-05  9.14317934e-05
  -4.80386137e-04  1.53437105e-03  2.17285170e-03 -2.73628772e-04
   1.53131492e-03 -3.73728653e-06 -9.06195899e-04 -1.06619136e-05
   7.29639491e-04 -1.55875125e-04 -1.54728326e-03  5.44335286e-04
   1.95594490e-04  6.75246643e-04  1.70648258e-04  7.74169748e-05
  -1.57024275e-04 -3.92497564e-03  5.64095217e-06 -1.42851422e-04
  -1.71953852e-05 -7.77756213e-05  2.29247060e-04 -4.19333635e-04
  -7.03529658e-05  1.43110356e-03 -1.37202453e-03  4.63388016e-04
   3.11775395e-04  2.60234898e-04 -4.47966158e-04 -1.46542373e-03
  -9.52879054e-05 -2.75271217e-04  5.49504242e-04  7.71317224e-04
   3.02752509e-04  7.50149411e-06  9.14877746e-04  9.69857574e-05
  -2.97523639e-03  4.53132525e-04  1.83046868e-04  1.44990554e-04
  -4.34295507e-04  2.84087787e-06 -6.12682561e-05  6.01981650e-04
  -3.96043947e-03 -6.43577718e-04  2.88310647e-03 -1.98468129e-04
   7.52634078e-05  1.73629192e-03 -9.16079909e-04  7.19761418e-04
   8.17940381e-05 -7.11323111e-04 -1.54720817e-03  2.82202440e-04
   3.93275230e-04  5.41283458e-04  7.98940950e-04  2.49581644e-04
   3.10353753e-05  6.22164807e-04  1.21138946e-04  1.57898327e-03]
 [ 1.09781693e-04  9.32310359e-04 -2.61777692e-04  2.87221250e-04
   4.95442888e-04  2.24804753e-04 -6.98349368e-06 -2.98956904e-04
  -7.64917873e-04 -1.18841286e-04  4.66752244e-05 -1.03618913e-04
  -3.20584420e-03 -2.57150666e-03 -6.55689510e-04 -3.01158347e-04
   1.53311950e-04  1.70142215e-04  5.81682776e-04 -1.43863377e-03
  -7.89874874e-04  7.30178217e-05  4.04739330e-05  2.87493807e-04
  -3.88306304e-04  9.47614317e-05 -9.19149956e-04  2.06090936e-05
   9.49276437e-04  3.02321103e-04 -7.85209704e-04  9.02504598e-06
   5.37378713e-04 -4.59567964e-05  4.30339744e-04 -4.73916079e-05
  -5.45359275e-04 -1.82123957e-04  1.29167200e-03 -1.05130218e-03
  -4.93909407e-04  1.26575600e-04  6.86197076e-04  1.69355283e-03
   1.64914163e-04 -5.09129204e-05  7.07314583e-04  5.90121315e-04
  -3.38269980e-04 -1.23466912e-03  1.79382274e-04 -4.76524019e-06
  -4.72022657e-04 -6.33090502e-04  2.32041275e-04 -2.12555082e-04
  -6.71468733e-04  2.11480277e-04 -1.75834907e-06  9.02764150e-05
  -2.94819212e-04  1.99355069e-03  2.11496977e-03  2.36745414e-04
   1.22164714e-03 -8.50095821e-05 -3.95149313e-04  7.91034181e-05
   4.52082226e-04  7.86160581e-06 -1.71213003e-03  5.21211943e-04
   2.45076844e-05  4.37518727e-04 -4.42792807e-04  2.46899144e-05
  -5.86962444e-04 -2.01448263e-03  7.04417544e-05  1.81107025e-04
  -1.47103550e-04  1.26451356e-04 -1.41218479e-04 -1.29043605e-04
   2.99355015e-05  7.88420322e-04 -1.01357757e-03  5.85245260e-04
   1.09306653e-04  5.21036447e-04 -1.75162233e-04 -5.38655848e-04
   1.21275152e-05 -1.69383537e-04  1.35978952e-03  1.15810276e-03
  -3.54365795e-04  1.45019978e-04 -2.78252468e-04  2.96451588e-04
  -2.20627547e-03  1.38987802e-04 -1.26502186e-04  9.49299501e-05
   2.85471440e-04  9.53297204e-05 -2.45026546e-04  1.29938114e-03
  -6.61227154e-04 -4.14921291e-04  4.87646321e-04 -1.11263973e-04
  -7.13877016e-05  1.01644883e-03 -1.83136217e-04  4.89443250e-04
   2.83963105e-04 -9.17749305e-04 -5.93992474e-04  5.28358541e-05
   8.43174075e-06 -1.82385356e-05  5.09660691e-04  9.77156815e-05
   6.56312259e-05  3.15224781e-04  2.22589224e-04  2.73104815e-04]]
